---
layout: post
title: 写一个规范的接口供其它系统调用
description: 接口调用规范
tag: java
---

## 1.入参

##### 1.1 URL

```
API请求路径+加上固定的参数（比如token之类的）
如果和外部系统做对接，可以加上一些额外的参数标识,配合@RequestMapping做请求的过滤
```

##### 1.2 请求头

```
指定一些参数类型，比如：
Content-Type：text/xml;charset=UTF-8 || text/xml;charset=UTF-8等等...
如果和外部系统做对接，可以加上一些额外的参数标识,配合@RequestMapping做请求的过滤
也可以将请求token放在头里
```

##### 1.3 请求参数

```
入参形式：无特殊要求，则以JSON入参，可分为两部分
{
  "header":{
     "externalSystemCode":外部系统标识,
     "batchNum":批次号(数据唯一性) 防止一条数据多次调用,
     "interfaceCode":接口标识
  },
  "body":{
  具体参数:
  }
}
字段说明：
字段名 字段类型 字段长度 是否必输 是否固定值 固定值 都是缺一不可的
```

### 2. 处理过程

```
给外部系统调用的接口，一定要对每一次调用记录都进行持久化，所以要建接口表和业务表。像SPRING CLOUD服务，则分接口服务和业务服务，所有的请求数据都要在接口服务里进行校验、过滤，正确的数据在进行远程调用业务服务进行CURD；错误的数据则进行记录
```

### 3.返回参数

```java
参数形式，无特殊要求，以JSON字符串形式返回
一般包含三个字段
数据唯一标识：如批次号等等
数据状态：可定义为状态码或其它固定字段
返回信息：正确可以不用返回，错误则要返回错误信息，方便排错
```

### 4.细节处理

##### 4.1 对外接口的安全性

```
如果不经过页面点击，直接进行API的调用，可采用token令牌形式来保证数据来源准确性;
如果是通过页面点击访问API；可采用OAUTH2等授权协议来实现
```

##### 4.2 对外接口的幂等性

```
加上唯一批次号字段。每次请求都需要生产新的批次号，批次号的生成规则由调用方自行设计,
通过在表中添加唯一索引，通过索引来判断新增或更新
```

